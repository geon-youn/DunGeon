<!DOCTYPE html>
<html lang="en"><head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <meta name="twitter:card" content="summary_large_image" /><!-- Begin Jekyll SEO tag v2.8.0 -->
<title>Pixel Similarity vs. Basic Neural Net on the MNIST Dataset | Geon’s Blog</title>
<meta name="generator" content="Jekyll v4.1.1" />
<meta property="og:title" content="Pixel Similarity vs. Basic Neural Net on the MNIST Dataset" />
<meta property="og:locale" content="en_US" />
<meta name="description" content="The DunGeon that holds ipynbs" />
<meta property="og:description" content="The DunGeon that holds ipynbs" />
<link rel="canonical" href="https://geon-youn.github.io/DunGeon/2022/02/19/_02_20_MNIST.html" />
<meta property="og:url" content="https://geon-youn.github.io/DunGeon/2022/02/19/_02_20_MNIST.html" />
<meta property="og:site_name" content="Geon’s Blog" />
<meta property="og:type" content="article" />
<meta property="article:published_time" content="2022-02-19T00:00:00-06:00" />
<meta name="twitter:card" content="summary" />
<meta property="twitter:title" content="Pixel Similarity vs. Basic Neural Net on the MNIST Dataset" />
<script type="application/ld+json">
{"@context":"https://schema.org","@type":"BlogPosting","dateModified":"2022-02-19T00:00:00-06:00","datePublished":"2022-02-19T00:00:00-06:00","description":"The DunGeon that holds ipynbs","headline":"Pixel Similarity vs. Basic Neural Net on the MNIST Dataset","mainEntityOfPage":{"@type":"WebPage","@id":"https://geon-youn.github.io/DunGeon/2022/02/19/_02_20_MNIST.html"},"url":"https://geon-youn.github.io/DunGeon/2022/02/19/_02_20_MNIST.html"}</script>
<!-- End Jekyll SEO tag -->
<link rel="stylesheet" href="/DunGeon/assets/css/style.css"><link type="application/atom+xml" rel="alternate" href="https://geon-youn.github.io/DunGeon/feed.xml" title="Geon's Blog" /><link rel="shortcut icon" type="image/x-icon" href="/DunGeon/images/icon.png">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Primer/15.2.0/primer.css" integrity="sha512-xTz2ys4coGAOz8vuV1NcQBkgVmKhsSEtjbqyMJbBHRplFuvKIUo6xhLHpAyPt9mfR6twHJgn9OgVLuqOvjeBhg==" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css" integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.css" integrity="sha512-h7nl+xz8wgDlNM4NqKEM4F1NkIRS17M9+uJwIGwuo8vGqIl4BhuCKdxjWEINm+xyrUjNCnK5dCrhM0sj+wTIXw==" crossorigin="anonymous" />
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/katex.min.js" integrity="sha512-/CMIhXiDA3m2c9kzRyd97MTb3MC6OVnx4TElQ7fkkoRghwDf6gi41gaT1PwF270W6+J60uTmwgeRpNpJdRV6sg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.12.0/contrib/auto-render.min.js" integrity="sha512-Do7uJAaHZm5OLrIv/yN4w0iG1dbu01kzdMNnFfu/mAqgUk6Nniv2JYHcwH+cNwjqgLcqcuBBk+JRvprLVI8azg==" crossorigin="anonymous"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha512-0doc9hKxR3PYwso42RD1p5ySZpzzuDiOwMrdCEh2WdJZCjcmFKc/wEnL+z8fBQrnHoiNWbo+3fiGkOYXBdQp4A==" crossorigin="anonymous"></script>
    <script>
    document.addEventListener("DOMContentLoaded", function() {
        renderMathInElement( document.body, {
        delimiters: [
            {left: "$$", right: "$$", display: true},
            {left: "[%", right: "%]", display: true},
            {left: "$", right: "$", display: false}
        ]}
        );
    });
    </script>


<script>
function wrap_img(fn) {
    if (document.attachEvent ? document.readyState === "complete" : document.readyState !== "loading") {
        var elements = document.querySelectorAll(".post img");
        Array.prototype.forEach.call(elements, function(el, i) {
            if (el.getAttribute("title") && (el.className != "emoji")) {
                const caption = document.createElement('figcaption');
                var node = document.createTextNode(el.getAttribute("title"));
                caption.appendChild(node);
                const wrapper = document.createElement('figure');
                wrapper.className = 'image';
                el.parentNode.insertBefore(wrapper, el);
                el.parentNode.removeChild(el);
                wrapper.appendChild(el);
                wrapper.appendChild(caption);
            }
        });
    } else { document.addEventListener('DOMContentLoaded', fn); }
}
window.onload = wrap_img;
</script>

<script>
    document.addEventListener("DOMContentLoaded", function(){
    // add link icon to anchor tags
    var elem = document.querySelectorAll(".anchor-link")
    elem.forEach(e => (e.innerHTML = '<i class="fas fa-link fa-xs"></i>'));
    });
</script>
</head>
<body><header class="site-header">

  <div class="wrapper"><a class="site-title" rel="author" href="/DunGeon/">Geon&#39;s Blog</a><nav class="site-nav">
        <input type="checkbox" id="nav-trigger" class="nav-trigger" />
        <label for="nav-trigger">
          <span class="menu-icon">
            <svg viewBox="0 0 18 15" width="18px" height="15px">
              <path d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.032C17.335,0,18,0.665,18,1.484L18,1.484z M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.032C17.335,6.031,18,6.696,18,7.516L18,7.516z M18,13.516C18,14.335,17.335,15,16.516,15H1.484 C0.665,15,0,14.335,0,13.516l0,0c0-0.82,0.665-1.483,1.484-1.483h15.032C17.335,12.031,18,12.695,18,13.516L18,13.516z"/>
            </svg>
          </span>
        </label>

        <div class="trigger"><a class="page-link" href="/DunGeon/about/">About Me</a><a class="page-link" href="/DunGeon/search/">Search</a><a class="page-link" href="/DunGeon/categories/">Tags</a></div>
      </nav></div>
</header>
<main class="page-content" aria-label="Content">
      <div class="wrapper">
        <article class="post h-entry" itemscope itemtype="http://schema.org/BlogPosting">

  <header class="post-header">
    <h1 class="post-title p-name" itemprop="name headline">Pixel Similarity vs. Basic Neural Net on the MNIST Dataset</h1><p class="post-meta post-meta-title"><time class="dt-published" datetime="2022-02-19T00:00:00-06:00" itemprop="datePublished">
        Feb 19, 2022
      </time>
       • <span class="read-time" title="Estimated read time">
    
    
      8 min read
    
</span></p>

    

    
      
        <div class="pb-5 d-flex flex-justify-center">
          <div class="px-2">

    <a href="https://github.com/geon-youn/DunGeon/tree/master/_notebooks/2022_02_20_MNIST.ipynb" role="button" target="_blank">
<img class="notebook-badge-image" src="/DunGeon/assets/badges/github.svg" alt="View On GitHub">
    </a>
</div>

          <div class="px-2">
    <a href="https://mybinder.org/v2/gh/geon-youn/DunGeon/master?filepath=_notebooks%2F2022_02_20_MNIST.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/DunGeon/assets/badges/binder.svg" alt="Open In Binder"/>
    </a>
</div>

          <div class="px-2">
    <a href="https://colab.research.google.com/github/geon-youn/DunGeon/blob/master/_notebooks/2022_02_20_MNIST.ipynb" target="_blank">
        <img class="notebook-badge-image" src="/DunGeon/assets/badges/colab.svg" alt="Open In Colab"/>
    </a>
</div>
          <div class="px-2">
  <a href="https://deepnote.com/launch?url=https%3A%2F%2Fgithub.com%2Fgeon-youn%2FDunGeon%2Fblob%2Fmaster%2F_notebooks%2F2022_02_20_MNIST.ipynb" target="_blank">
      <img class="notebook-badge-image" src="/DunGeon/assets/badges/deepnote.svg" alt="Launch in Deepnote"/>
  </a>
</div>

        </div>
      </header>

  <div class="post-content e-content" itemprop="articleBody">
    <!--
#################################################
### THIS FILE WAS AUTOGENERATED! DO NOT EDIT! ###
#################################################
# file to edit: _notebooks/2022_02_20_MNIST.ipynb
-->

<div class="container" id="notebook-container">
        
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h2 id="Pixel-Similarity">Pixel Similarity<a class="anchor-link" href="#Pixel-Similarity"> </a></h2><p>We will take the average of each digit to get its "perfect" version. Then, we compare an image to each of those perfect numbers and see which one is the most similar.</p>
<p>First, we'll download the MNIST dataset:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>The dataset is separated into training and testing subfolders, where in those folders, there are separate folders for each digit:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">Path</span><span class="o">.</span><span class="n">BASE_PATH</span> <span class="o">=</span> <span class="n">path</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">path</span><span class="o">.</span><span class="n">ls</span><span class="p">(),(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;training&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>((#2) [Path(&#39;testing&#39;),Path(&#39;training&#39;)],
 (#10) [Path(&#39;training/7&#39;),Path(&#39;training/8&#39;),Path(&#39;training/1&#39;),Path(&#39;training/6&#39;),Path(&#39;training/3&#39;),Path(&#39;training/2&#39;),Path(&#39;training/5&#39;),Path(&#39;training/4&#39;),Path(&#39;training/0&#39;),Path(&#39;training/9&#39;)])</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll store the path of each image in an array, where the <code>i</code>th row contains the path for the <code>i</code>th digit:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">nums</span> <span class="o">=</span> <span class="p">[(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;training&#39;</span><span class="o">/</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">im3_path</span> <span class="o">=</span> <span class="n">nums</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">im3</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">im3_path</span><span class="p">)</span>
<span class="n">im3</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_png output_subarea output_execute_result">
<img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABwAAAAcCAAAAABXZoBIAAAA5klEQVR4nGNgoD9gRGJr+aSevsAw4Rc2demf/v379++fE1ZDhF78+/fv3793blhlM778e/Dv379e7A44/+/Sv3//lLBLhpz79+/fP00cbpe4+O/fv9VwLguyXLSeDgMDw1Fs2jSu/fr3D8VOJoSkpiLEmAKsNuZ9+/cPp52TbgswsEzmw+FYBgYGxoZ/t+VxSbL/+3dNBpdk179/JehiwhujGBgYGBgkP2AJviX/rturMBhHnvv3r5sDXdLy6L9/97Z8/Pfv71VuTLt6Mv/9+/fv3783yIIwf5aw8zAYRDJ8xB7TdAQABFdhZWAfWxoAAAAASUVORK5CYII=
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we'll open the images, put every image of the same digit into their own tensor and store them as a list of tensors:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">nums_tens</span> <span class="o">=</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">nums_tens</span> <span class="o">=</span> <span class="p">[</span><span class="n">nums_tens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can then take the mean of one of the tensors to get its "perfect" version. Here is how it looks like for a <code>3</code>:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">stacked_threes</span> <span class="o">=</span> <span class="n">nums_tens</span><span class="p">[</span><span class="mi">3</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">stacked_threes</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb1e3d3acd0&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And to compare, here is just one of those threes:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">a_3</span> <span class="o">=</span> <span class="n">nums_tens</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">a_3</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb1e36f1750&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we'll create a function that compares two tensors through absolute mean difference:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">mnist_distance</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span> 
    <span class="k">return</span> <span class="p">(</span><span class="n">x1</span> <span class="o">-</span> <span class="n">x2</span><span class="p">)</span><span class="o">.</span><span class="n">abs</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we can compare one of the threes with its "perfect" version. The number doesn't really mean anything until we compare it with another number:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">mnist_distance</span><span class="p">(</span><span class="n">a_3</span><span class="p">,</span> <span class="n">stacked_threes</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.1074)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>So, we'll take the average seven and take the L1 norm (absolute mean difference) and compare that number with the number we just got (<code>0.1074</code>)</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">stacked_sevens</span> <span class="o">=</span> <span class="n">nums_tens</span><span class="p">[</span><span class="mi">7</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">stacked_sevens</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb1e0401510&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">mnist_distance</span><span class="p">(</span><span class="n">a_3</span><span class="p">,</span> <span class="n">stacked_sevens</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>tensor(0.1441)</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, the distance between the <code>3</code> and the average <code>3</code> is smaller than the distance between the <code>3</code> and the average <code>7</code>. So, it is <em>more three than seven</em>. We'll extend this approach by comparing an image with the average for each digit and say it is the digit it is the most similar to (its L1 norm with that average digit is the smallest).</p>
<p>We'll create the average number for each digit:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">stacked_nums</span> <span class="o">=</span> <span class="p">[</span><span class="n">nums_tens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">stacked_nums</span><span class="p">[</span><span class="mi">4</span><span class="p">])</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb1e2b5e150&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We can compare our <code>3</code> to each average digit:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">L</span><span class="p">(</span><span class="n">mnist_distance</span><span class="p">(</span><span class="n">a_3</span><span class="p">,</span> <span class="n">stacked_nums</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#10) [tensor(0.1750),tensor(0.1153),tensor(0.1501),tensor(0.1074),tensor(0.1635),tensor(0.1326),tensor(0.1579),tensor(0.1441),tensor(0.1345),tensor(0.1402)]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>As you can see, it is most similar to the average three.</p>
<p>Now we'll import the validation set and put them into a list of tensors:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">valid_nums</span> <span class="o">=</span> <span class="p">[(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;testing&#39;</span><span class="o">/</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">valid_nums_tens</span> <span class="o">=</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">valid_nums</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">valid_nums_tens</span> <span class="o">=</span> <span class="p">[</span><span class="n">valid_nums_tens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll create a function that returns the accuracy of our whole process:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="k">def</span> <span class="nf">is_num</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2s</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="c1"># Get the distance between the number and the average digit for each digit</span>
    <span class="n">vals</span> <span class="o">=</span> <span class="p">[</span><span class="n">mnist_distance</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2s</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>

    <span class="c1"># Turn the tensors into floats so that we can perform the `min` function</span>
    <span class="n">vals_2</span> <span class="o">=</span> <span class="p">[[</span><span class="n">vals</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span><span class="o">.</span><span class="n">item</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">))]</span>

    <span class="c1"># Get a list of tensors that contain a bool value, where it&#39;s true when</span>
    <span class="c1"># the minimum distance is equal to the digit the given number is supposed</span>
    <span class="c1"># to be</span>
    <span class="n">vals_3</span> <span class="o">=</span> <span class="p">[</span><span class="n">tensor</span><span class="p">(</span><span class="n">vals_2</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">min</span><span class="p">(</span><span class="n">vals_2</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="o">==</span> <span class="n">x</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">x1</span><span class="p">))]</span>

    <span class="c1"># Return how often our model is correct</span>
    <span class="k">return</span> <span class="n">tensor</span><span class="p">(</span><span class="n">vals_3</span><span class="p">)</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">nums_accuracy</span> <span class="o">=</span> <span class="n">tensor</span><span class="p">([</span><span class="n">is_num</span><span class="p">(</span><span class="n">valid_nums_tens</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">stacked_nums</span><span class="p">,</span> <span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
<span class="n">nums_accuracy</span><span class="p">,</span> <span class="n">nums_accuracy</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(tensor([0.8153, 0.9982, 0.4234, 0.6089, 0.6680, 0.3262, 0.7871, 0.7646, 0.4425, 0.7760]),
 tensor(0.6610))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our model has an overall accuracy of <code>66.1%</code>! Better than a random guess of <code>10%</code>, but certainly not good. It is particularly good at guessing if a number is a <code>1</code>, but particularly bad for <code>2</code>s, <code>5</code>s and <code>8</code>s.</p>
<p>Now that we have a baseline, we can try how good we can get a simple model "from scratch."</p>

</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<h1 id="Learner">Learner<a class="anchor-link" href="#Learner"> </a></h1>
</div>
</div>
</div>
<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>For our "from scratch" learner, we'll have 2 layers, where each layer contains a linear layer and a ReLU (rectified linear unit, where all negative numbers become <code>0</code>).</p>
<p>For our loss function, we will be using cross-entropy loss since we have multiple categories.</p>
<p>First, we'll make our training and validation datasets and dataloaders. Then, we'll initialize parameters, figure out how to make predictions, calculate the loss (cross-entropy), calculate the gradients, and then step (using the provided SGD optimizer).</p>
<p>Let's first redownload the MNIST dataset:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">path</span> <span class="o">=</span> <span class="n">untar_data</span><span class="p">(</span><span class="n">URLs</span><span class="o">.</span><span class="n">MNIST</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">Path</span><span class="o">.</span><span class="n">BASE_PATH</span> <span class="o">=</span> <span class="n">path</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">path</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(#2) [Path(&#39;testing&#39;),Path(&#39;training&#39;)]</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we'll save the training and validation images into separate variables:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">nums</span> <span class="o">=</span> <span class="p">[(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;training&#39;</span><span class="o">/</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">x</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">nums_tens</span> <span class="o">=</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">nums</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">nums_tens</span> <span class="o">=</span> <span class="p">[</span><span class="n">nums_tens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">valid_nums</span> <span class="o">=</span> <span class="p">[(</span><span class="n">path</span><span class="o">/</span><span class="s1">&#39;testing&#39;</span><span class="o">/</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">ls</span><span class="p">()</span><span class="o">.</span><span class="n">sorted</span><span class="p">()</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">valid_nums_tens</span> <span class="o">=</span> <span class="p">[</span><span class="n">torch</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">tensor</span><span class="p">(</span><span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">j</span><span class="p">))</span> <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">valid_nums</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
<span class="n">valid_nums_tens</span> <span class="o">=</span> <span class="p">[</span><span class="n">valid_nums_tens</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">float</span><span class="p">()</span><span class="o">/</span><span class="mi">255</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)]</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we'll create our dataset from our training set. A dataset is a list of tuples, which contains the independent variable and its label (dependent variable) like so: <code>(independent, dependent)</code>.</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">train_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">nums_tens</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>It took a while for me to realize what the <code>.view()</code> function was doing, but what it does is pretty simple. We give it however many values we want (that makes sense) to change the shape of our tensor. Here we give it <code>-1, 28*28</code> which will turn our rank-3 tensor (<code>n</code>-images of 28 by 28) into a rank-2 tensor (<code>n</code>-images of 28*28). <code>-1</code> makes it so that we don't have to specify how many images there are and <code>28*28</code> means we want to compress our previous <code>28</code> by <code>28</code> grid into a <code>28*28</code> vector. It's like turning a 2D array into a 1D array:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">nums_tens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">nums_tens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">5923</span><span class="p">,</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([5923, 784]), torch.Size([5923, 784]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">nums_tens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">size</span><span class="p">(),</span> <span class="n">nums_tens</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([5923, 28, 28]), torch.Size([5923, 784]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll form our labels by having as many tensors containing the digit's digit as there are of that digit:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">train_y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">tensor</span><span class="p">([</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums_tens</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">train_x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">train_y</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([60000, 784]), torch.Size([60000]))</pre>
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="c1"># that we can 3 as its label</span>
<span class="n">show_image</span><span class="p">(</span><span class="n">nums_tens</span><span class="p">[</span><span class="mi">3</span><span class="p">][</span><span class="mi">200</span><span class="p">]),</span> <span class="n">train_y</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">nums_tens</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums_tens</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">nums_tens</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span> <span class="o">+</span><span class="mi">200</span><span class="p">]</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb1e2aa69d0&gt;, tensor(3))</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Like I said before, a dataset is just a list of tuples containing our independent and dependent variabbles:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">dset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">train_x</span><span class="p">,</span> <span class="n">train_y</span><span class="p">))</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">dset</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">y</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([784]), tensor(0))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And we can see that given a label <code>0</code>, our image is indeed a zero:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">show_image</span><span class="p">(</span><span class="n">x</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="mi">28</span><span class="p">,</span> <span class="mi">28</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>&lt;matplotlib.axes._subplots.AxesSubplot at 0x7fb1d9324110&gt;</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Now we'll make the dataset for our validation set:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">valid_x</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">(</span><span class="n">valid_nums_tens</span><span class="p">)</span><span class="o">.</span><span class="n">view</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">28</span><span class="o">*</span><span class="mi">28</span><span class="p">)</span>
<span class="n">valid_y</span> <span class="o">=</span> <span class="n">torch</span><span class="o">.</span><span class="n">cat</span><span class="p">([</span><span class="n">tensor</span><span class="p">([</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">valid_nums_tens</span><span class="p">[</span><span class="n">i</span><span class="p">]))</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">)])</span>
<span class="n">valid_dset</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">valid_x</span><span class="p">,</span> <span class="n">valid_y</span><span class="p">))</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Next, we'll create <code>DataLoader</code>s for our training and validation sets. A <code>DataLoader</code> takes a dataset and each time we use it, it will give a portion of the dataset. We can then work on a portion of the dataset instead of just 1 tuple or the entire set. We can also toggle whether we want our given portion to be randomize (we wouldn't want to get all <code>0</code>s, then <code>1</code>s, then <code>2</code>s, ... we want a mix):</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">dset</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">valid_dl</span> <span class="o">=</span> <span class="n">DataLoader</span><span class="p">(</span><span class="n">valid_dset</span><span class="p">,</span> <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">128</span><span class="p">,</span> <span class="n">shuffle</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>
<span class="n">xb</span><span class="p">,</span> <span class="n">yb</span> <span class="o">=</span> <span class="n">first</span><span class="p">(</span><span class="n">dl</span><span class="p">)</span>
<span class="n">xb</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">yb</span><span class="o">.</span><span class="n">shape</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>(torch.Size([128, 784]), torch.Size([128]))</pre>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Then, we'll create our <code>DataLoaders</code>. A <code>DataLoaders</code> is like the dataset of a <code>DataLoader</code>: it just contains our training and validation <code>DataLoader</code>s:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">dls</span> <span class="o">=</span> <span class="n">DataLoaders</span><span class="p">(</span><span class="n">dl</span><span class="p">,</span> <span class="n">valid_dl</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our simple neural network uses PyTorch's <code>nn.Sequential</code> which takes modules and uses the GPU to handle the operations:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">simple_net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Sequential</span><span class="p">(</span>
    <span class="c1"># Our first layer takes in 28*28 inputs and outputs 250 </span>
    <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">28</span> <span class="o">*</span> <span class="mi">28</span><span class="p">,</span> <span class="mi">250</span><span class="p">),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>

    <span class="c1"># Our second layer takes in 250 inputs and outputs 50</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">250</span><span class="p">,</span> <span class="mi">50</span><span class="p">),</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">(),</span>

    <span class="c1"># Our final layer takes in 50 inputs and outputs 10</span>
    <span class="c1"># (its confidence for our image to be each digit)</span>
    <span class="n">nn</span><span class="o">.</span><span class="n">Linear</span><span class="p">(</span><span class="mi">50</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We use cross-entropy loss so that we can turn our 10 outputs into numbers that are from 0 to 1 and sum to 1 like probabilities (through softmax). But, that's just the first part. We then take the negative log (<code>-log(p)</code>) of those probabilities to give emphasis on the higher probabilities.</p>
<p>We'll use the given <code>Learner</code> class from fastai (which handles epochs) with the <code>SGD</code> optimizer (stochastic gradient descent, which handles calculating gradients and stepping into lower loss) and use the accuracy metric (the number we care about).</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">learn</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">(</span><span class="n">dls</span><span class="p">,</span> <span class="n">simple_net</span><span class="p">,</span> <span class="n">opt_func</span> <span class="o">=</span> <span class="n">SGD</span><span class="p">,</span> <span class="n">loss_func</span> <span class="o">=</span> <span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">,</span> <span class="n">metrics</span> <span class="o">=</span> <span class="n">accuracy</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>We'll use the learning rate finder to select a good learning rate for us:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">lrs</span> <span class="o">=</span> <span class="n">learn</span><span class="o">.</span><span class="n">lr_find</span><span class="p">()</span>
<span class="n">lrs</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">

</div>

</div>

<div class="output_area">



<div class="output_text output_subarea output_execute_result">
<pre>SuggestedLRs(valley=0.04786301031708717)</pre>
</div>

</div>

<div class="output_area">



<div class="output_png output_subarea ">
<img src="data:image/png;base64,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
" />
</div>

</div>

</div>
</div>

</div>
    

    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">learn</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span> <span class="n">lr</span> <span class="o">=</span> <span class="n">lrs</span><span class="o">.</span><span class="n">valley</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.454874</td>
      <td>0.400172</td>
      <td>0.889500</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>1</td>
      <td>0.322119</td>
      <td>0.292965</td>
      <td>0.916900</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>2</td>
      <td>0.264725</td>
      <td>0.245524</td>
      <td>0.929800</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>3</td>
      <td>0.228520</td>
      <td>0.216811</td>
      <td>0.938200</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>4</td>
      <td>0.196191</td>
      <td>0.187768</td>
      <td>0.945100</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>5</td>
      <td>0.181299</td>
      <td>0.170362</td>
      <td>0.950000</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>6</td>
      <td>0.151747</td>
      <td>0.152564</td>
      <td>0.954600</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>7</td>
      <td>0.143972</td>
      <td>0.141233</td>
      <td>0.957100</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>8</td>
      <td>0.125890</td>
      <td>0.130209</td>
      <td>0.961300</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>9</td>
      <td>0.119570</td>
      <td>0.117828</td>
      <td>0.964100</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>10</td>
      <td>0.112297</td>
      <td>0.120144</td>
      <td>0.963900</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>11</td>
      <td>0.096248</td>
      <td>0.108321</td>
      <td>0.967100</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>12</td>
      <td>0.085236</td>
      <td>0.100657</td>
      <td>0.970100</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>13</td>
      <td>0.082346</td>
      <td>0.094316</td>
      <td>0.970200</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>14</td>
      <td>0.077736</td>
      <td>0.090774</td>
      <td>0.972000</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>15</td>
      <td>0.075661</td>
      <td>0.093964</td>
      <td>0.971500</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>16</td>
      <td>0.064168</td>
      <td>0.087111</td>
      <td>0.973000</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>17</td>
      <td>0.062180</td>
      <td>0.080836</td>
      <td>0.975900</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>18</td>
      <td>0.061466</td>
      <td>0.077446</td>
      <td>0.977300</td>
      <td>00:02</td>
    </tr>
    <tr>
      <td>19</td>
      <td>0.052969</td>
      <td>0.078910</td>
      <td>0.975300</td>
      <td>00:02</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>And we see that our final accuracy is <code>97.5%</code>! Certainly better than the <code>66.1%</code> we got from our pixel similarity approach.</p>
<p>To compare, here's the results using fastai's provided <code>cnn_learner</code> which uses a pretrained model with 18 layers:</p>

</div>
</div>
</div>
    
    
<div class="cell border-box-sizing code_cell rendered">
<div class="input">

<div class="inner_cell">
    <div class="input_area">
<div class=" highlight hl-python"><pre><span></span><span class="n">dls2</span> <span class="o">=</span> <span class="n">ImageDataLoaders</span><span class="o">.</span><span class="n">from_folder</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">train</span><span class="o">=</span><span class="s1">&#39;training&#39;</span><span class="p">,</span> <span class="n">valid</span><span class="o">=</span><span class="s1">&#39;testing&#39;</span><span class="p">)</span>
<span class="n">learn2</span> <span class="o">=</span> <span class="n">cnn_learner</span><span class="p">(</span><span class="n">dls2</span><span class="p">,</span> <span class="n">resnet18</span><span class="p">,</span> <span class="n">loss_func</span><span class="o">=</span><span class="n">F</span><span class="o">.</span><span class="n">cross_entropy</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">accuracy</span><span class="p">)</span>
<span class="n">learn2</span><span class="o">.</span><span class="n">fit_one_cycle</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">)</span>
</pre></div>

    </div>
</div>
</div>

<div class="output_wrapper">
<div class="output">

<div class="output_area">


<div class="output_html rendered_html output_subarea ">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: left;">
      <th>epoch</th>
      <th>train_loss</th>
      <th>valid_loss</th>
      <th>accuracy</th>
      <th>time</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td>0</td>
      <td>0.124300</td>
      <td>0.056642</td>
      <td>0.982900</td>
      <td>02:04</td>
    </tr>
  </tbody>
</table>
</div>

</div>

</div>
</div>

</div>
    

<div class="cell border-box-sizing text_cell rendered"><div class="inner_cell">
<div class="text_cell_render border-box-sizing rendered_html">
<p>Our model is not bad considering it's less than <code>1%</code> in accuracy different from a pretrained model.</p>
<p>We could even make our model better by training for more epochs until the validation loss becomes worse or by using a deeper model.</p>

</div>
</div>
</div>
</div>



  </div><a class="u-url" href="/DunGeon/2022/02/19/_02_20_MNIST.html" hidden></a>
</article>

      </div>
    </main><footer class="site-footer h-card">
  <data class="u-url" href="/DunGeon/"></data>

  <div class="wrapper">

    <div class="footer-col-wrapper">
      <div class="footer-col">
        <p class="feed-subscribe">
          <a href="/DunGeon/feed.xml">
            <svg class="svg-icon orange">
              <use xlink:href="/DunGeon/assets/minima-social-icons.svg#rss"></use>
            </svg><span>Subscribe</span>
          </a>
        </p>
      </div>
      <div class="footer-col">
        <p>The DunGeon that holds ipynbs</p>
      </div>
    </div>

    <div class="social-links"><ul class="social-media-list"><li><a rel="me" href="https://github.com/geon-youn" target="_blank" title="geon-youn"><svg class="svg-icon grey"><use xlink:href="/DunGeon/assets/minima-social-icons.svg#github"></use></svg></a></li><li><a rel="me" href="https://twitter.com/griolu" target="_blank" title="griolu"><svg class="svg-icon grey"><use xlink:href="/DunGeon/assets/minima-social-icons.svg#twitter"></use></svg></a></li></ul>
</div>

  </div>

</footer>
</body>

</html>
